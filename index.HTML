<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Autenticação - Predictor System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card {
            transition: all 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: none;
        }
        .notification.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .sidebar-link {
            transition: all 0.2s;
        }
        .sidebar-link:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        .sidebar-link.active {
            background-color: rgba(255, 255, 255, 0.2);
            border-left: 4px solid #fff;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .password-strength {
            height: 4px;
            border-radius: 2px;
            transition: all 0.3s;
        }
        .strength-weak { background-color: #ef4444; width: 33%; }
        .strength-medium { background-color: #f59e0b; width: 66%; }
        .strength-strong { background-color: #10b981; width: 100%; }
    </style>
</head>
<body class="min-h-screen">
    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="bg-white rounded-lg shadow-lg p-4 max-w-sm">
            <div class="flex items-center">
                <div id="notificationIcon" class="flex-shrink-0">
                    <i class="fas fa-check-circle text-green-500 text-xl"></i>
                </div>
                <div class="ml-3">
                    <p id="notificationMessage" class="text-sm font-medium text-gray-900">
                        Operação realizada com sucesso!
                    </p>
                </div>
                <div class="ml-auto pl-3">
                    <button onclick="hideNotification()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
        <div class="max-w-md w-full space-y-8">
            <div class="text-center">
                <div class="mx-auto h-20 w-20 bg-white rounded-full flex items-center justify-center shadow-lg">
                    <i class="fas fa-building text-blue-600 text-3xl"></i>
                </div>
                <h2 class="mt-6 text-3xl font-extrabold text-white">
                    Predictor System
                </h2>
                <p class="mt-2 text-sm text-gray-200">
                    Sistema de Predictor System
                </p>
            </div>
            <div class="bg-white rounded-lg shadow-xl p-8 card">
                <form id="loginForm" class="space-y-6">
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">
                            E-mail
                        </label>
                        <div class="mt-1 relative">
                            <input id="email" name="email" type="email" required 
                                   class="appearance-none relative block w-full px-3 py-2 pl-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm" 
                                   placeholder="Digite seu e-mail">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-envelope text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700">
                            Senha
                        </label>
                        <div class="mt-1 relative">
                            <input id="password" name="password" type="password" required 
                                   class="appearance-none relative block w-full px-3 py-2 pl-10 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm" 
                                   placeholder="Digite sua senha">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fas fa-lock text-gray-400"></i>
                            </div>
                            <button type="button" onclick="togglePassword('password')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                <i id="passwordToggle" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input id="remember" name="remember" type="checkbox" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                            <label for="remember" class="ml-2 block text-sm text-gray-900">
                                Lembrar-me
                            </label>
                        </div>
                        <div class="text-sm">
                            <a href="#" class="font-medium text-blue-600 hover:text-blue-500">
                                Esqueceu a senha?
                            </a>
                        </div>
                    </div>
                    <div>
                        <button type="submit" class="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out">
                            <span class="absolute left-0 inset-y-0 flex items-center pl-3">
                                <i class="fas fa-sign-in-alt text-blue-500 group-hover:text-blue-400"></i>
                            </span>
                            Entrar
                        </button>
                    </div>
                </form>
                
                <!-- Contact Info -->
                <div class="mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                    <div class="text-center">
                        <h4 class="text-sm font-medium text-gray-700 mb-3">🔒 Ainda não tem uma conta?</h4>
                        <p class="text-sm text-gray-600 mb-4">
                            Para criar uma conta de acesso, entre em contacto com o Administrador pelo número:
                        </p>
                        <div class="mb-4">
                            <span class="text-lg font-bold text-blue-600">📞 877 677 920</span>
                        </div>
                        <a href="https://api.whatsapp.com/send?phone=258877677920&text&context=AfdvhYcdB2zE19yV5JwayrcMxg5FErJ9EGMiDeYAKjX0kHavoFUKqchMLPDomCbnhewKmXSN8JMq9bpcDfqXRJEsvDCF0RxJPFoKXVM7r5m5uRyMQuLWNBtKZtQwDEp11fw-1ghkUQ4uapEJXJ9V_8e9oA&source&app=facebook" 
                           target="_blank" 
                           class="inline-flex items-center space-x-2 bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                            <i class="fab fa-whatsapp text-lg"></i>
                            <span>Contactar via WhatsApp</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden">
        <div class="flex h-screen bg-gray-100">
            <!-- Sidebar -->
            <div class="bg-gray-800 text-white w-64 space-y-6 py-7 px-2">
                <div class="flex items-center justify-center px-4">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-building text-blue-400 text-2xl"></i>
                        <span class="text-xl font-semibold">EmpresaGest</span>
                    </div>
                </div>
                
                <!-- User Info -->
                <div class="px-4 py-3 bg-gray-700 rounded-lg mx-2">
                    <div class="flex items-center space-x-3">
                        <img id="userAvatar" src="" alt="User" class="w-10 h-10 rounded-full">
                        <div>
                            <div id="userName" class="text-sm font-medium"></div>
                            <div id="userRole" class="text-xs text-gray-300"></div>
                        </div>
                    </div>
                </div>
                
                <nav class="mt-10">
                    <a href="#aviator" class="sidebar-link active block py-2.5 px-4 rounded transition duration-200 flex items-center space-x-3">
                        <i class="fas fa-plane"></i>
                        <span>AVIATOR</span>
                    </a>
                    <a href="#profile" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 flex items-center space-x-3">
                        <i class="fas fa-user"></i>
                        <span>Meu Perfil</span>
                    </a>
                    <div id="adminMenu" class="hidden">
                        <a href="#users" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 flex items-center space-x-3">
                            <i class="fas fa-users"></i>
                            <span>Gerenciar Usuários</span>
                        </a>
                        <a href="#reports" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 flex items-center space-x-3">
                            <i class="fas fa-chart-bar"></i>
                            <span>Relatórios Admin</span>
                        </a>
                    </div>
                    <a href="#settings" class="sidebar-link block py-2.5 px-4 rounded transition duration-200 flex items-center space-x-3">
                        <i class="fas fa-cog"></i>
                        <span>Configurações</span>
                    </a>
                </nav>
                
                <div class="px-4 mt-auto">
                    <button onclick="logout()" class="w-full bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center justify-center space-x-2">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Sair</span>
                    </button>
                </div>
            </div>

            <!-- Main Content -->
            <div class="flex-1 flex flex-col overflow-hidden">
                <!-- Top Header -->
                <header class="bg-white shadow-sm flex items-center justify-between p-4">
                    <div class="flex items-center">
                        <h1 id="pageTitle" class="text-2xl font-semibold text-gray-800">AVIATOR</h1>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <button class="p-2 rounded-full hover:bg-gray-200 relative">
                                <i class="fas fa-bell"></i>
                                <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">3</span>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-2">
                            <img id="headerUserAvatar" src="" alt="User" class="w-8 h-8 rounded-full">
                            <div class="text-sm">
                                <div id="headerUserName" class="font-semibold"></div>
                                <div id="headerUserRole" class="text-xs text-gray-500"></div>
                            </div>
                        </div>
                    </div>
                </header>
                
                <!-- Main Content Area -->
                <main class="flex-1 overflow-y-auto p-6 bg-gray-50">
                    <!-- AVIATOR Content -->
                    <div id="aviator-content" class="tab-content active">
                        <!-- Casa Selection Screen -->
                        <div id="casaSelection" class="bg-gradient-to-br from-gray-800 via-blue-900 to-indigo-900 rounded-lg shadow-2xl p-8 text-white">
                            <div class="text-center mb-8">
                                <h2 class="text-4xl font-bold mb-4 text-yellow-400">🎰 Escolha sua Casa de Apostas</h2>
                                <p class="text-xl opacity-90">Selecione onde você tem conta ou crie uma nova</p>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                                <!-- 888bets Option -->
                                <div class="bg-white bg-opacity-10 rounded-2xl p-8 hover:bg-opacity-20 transition-all duration-300 transform hover:scale-105">
                                    <div class="text-center mb-6">
                                        <div class="w-24 h-24 mx-auto mb-4 bg-orange-500 rounded-full flex items-center justify-center">
                                            <span class="text-3xl font-bold text-white">888</span>
                                        </div>
                                        <h3 class="text-2xl font-bold mb-2">888bets</h3>
                                        <p class="text-gray-300 mb-6">Casa de apostas líder em Moçambique</p>
                                    </div>
                                    
                                    <div class="space-y-4">
                                        <button onclick="selectCasa('888bets')" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200">
                                            ✅ Tenho Conta - Continuar
                                        </button>
                                        
                                        <a href="https://tracking.888africa.com/visit/?bta=227&brand=888mozambique" target="_blank" 
                                           class="block w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 text-center">
                                            🔥 Criar Conta Grátis
                                        </a>
                                    </div>
                                    
                                    <div class="mt-6 text-center">
                                        <div class="flex items-center justify-center space-x-2 text-sm text-gray-300">
                                            <i class="fas fa-star text-yellow-400"></i>
                                            <span>Bônus de Boas-vindas</span>
                                        </div>
                                        <div class="flex items-center justify-center space-x-2 text-sm text-gray-300 mt-1">
                                            <i class="fas fa-shield-alt text-green-400"></i>
                                            <span>100% Seguro e Licenciado</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Megalive Game Option -->
                                <div class="bg-white bg-opacity-10 rounded-2xl p-8 hover:bg-opacity-20 transition-all duration-300 transform hover:scale-105">
                                    <div class="text-center mb-6">
                                        <div class="w-24 h-24 mx-auto mb-4 bg-purple-600 rounded-full flex items-center justify-center">
                                            <span class="text-2xl font-bold text-white">MEGA</span>
                                        </div>
                                        <h3 class="text-2xl font-bold mb-2">Megalive Game</h3>
                                        <p class="text-gray-300 mb-6">Experiência de jogo premium</p>
                                    </div>
                                    
                                    <div class="space-y-4">
                                        <button onclick="selectCasa('megalive')" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200">
                                            ✅ Tenho Conta - Continuar
                                        </button>
                                        
                                        <a href="https://www.megagamelive.com/affiliates/?btag=2345693" target="_blank" 
                                           class="block w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-200 text-center">
                                            🎮 Criar Conta Grátis
                                        </a>
                                    </div>
                                    
                                    <div class="mt-6 text-center">
                                        <div class="flex items-center justify-center space-x-2 text-sm text-gray-300">
                                            <i class="fas fa-gift text-yellow-400"></i>
                                            <span>Promoções Exclusivas</span>
                                        </div>
                                        <div class="flex items-center justify-center space-x-2 text-sm text-gray-300 mt-1">
                                            <i class="fas fa-mobile-alt text-blue-400"></i>
                                            <span>App Mobile Otimizado</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-8 text-center">
                                <p class="text-gray-300 text-sm">
                                    ⚠️ Jogue com responsabilidade. Apostas envolvem riscos financeiros.
                                </p>
                            </div>
                        </div>
                        
                        <!-- Aviator Predictor (Hidden initially) -->
                        <div id="aviatorPredictor" class="bg-gradient-to-br from-gray-800 via-blue-900 to-indigo-900 rounded-lg shadow-2xl p-8 text-white hidden">
                            <div class="flex items-center justify-between mb-8">
                                <div>
                                    <h2 class="text-4xl font-bold mb-2 text-yellow-400">✈️ Aviator Predictor</h2>
                                    <p class="text-xl opacity-90">Sistema de Predição Inteligente</p>
                                </div>
                                <div class="text-right">
                                    <div id="selectedCasaInfo" class="bg-white bg-opacity-10 rounded-lg p-3">
                                        <div class="text-sm text-gray-300">Casa Selecionada:</div>
                                        <div id="selectedCasaName" class="font-bold text-lg"></div>
                                    </div>
                                    <button onclick="changeCasa()" class="mt-2 text-sm text-blue-300 hover:text-blue-100 underline">
                                        Trocar Casa de Apostas
                                    </button>
                                </div>
                            </div>
                            <!-- Predictor Area -->
                            <div class="max-w-md mx-auto bg-black bg-opacity-40 rounded-2xl p-8 mb-8">
                                <div class="relative w-52 h-52 mx-auto mb-6">
                                    <svg class="w-52 h-52 transform -rotate-90">
                                        <circle stroke="rgba(255,255,255,0.2)" fill="transparent" r="90" cx="104" cy="104" stroke-width="12"/>
                                        <circle id="progressCircle" stroke="#B22222" fill="transparent" r="90" cx="104" cy="104" stroke-width="12" stroke-linecap="round"/>
                                    </svg>
                                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
                                        <div id="multiplier" class="text-4xl font-bold text-white text-center">1.00x</div>
                                    </div>
                                </div>
                                
                                <div class="bg-white bg-opacity-10 rounded-lg h-3 mb-4 overflow-hidden">
                                    <div id="barFill" class="h-full bg-red-500 transition-all duration-100 ease-linear" style="width: 0%"></div>
                                </div>
                                
                                <div id="betMessage" class="text-center text-yellow-300 font-bold text-lg mb-4">
                                    🔥 Faça já a sua aposta 🔥
                                </div>
                                
                                <div id="signalBox" class="text-center py-3 px-6 rounded-xl font-bold text-lg mb-4 bg-red-700">
                                    🔴 Sinal Vermelho
                                </div>
                            </div>
                            
                            <!-- History and Info -->
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- History -->
                                <div class="bg-white bg-opacity-10 rounded-lg p-6">
                                    <h3 class="text-xl font-semibold mb-4">📊 Histórico de Resultados</h3>
                                    <div id="historyList" class="flex flex-wrap gap-2 max-h-32 overflow-y-auto">
                                        <!-- History items will be populated here -->
                                    </div>
                                </div>
                                
                                <!-- Prediction Info -->
                                <div class="bg-white bg-opacity-10 rounded-lg p-6">
                                    <h3 class="text-xl font-semibold mb-4">🎯 Sistema de Sinais</h3>
                                    <div class="space-y-3 text-sm">
                                        <div class="flex items-center space-x-3">
                                            <span class="w-4 h-4 bg-green-500 rounded-full"></span>
                                            <span>🟢 Sinal Verde: 85-100% de confiança</span>
                                        </div>
                                        <div class="flex items-center space-x-3">
                                            <span class="w-4 h-4 bg-red-500 rounded-full"></span>
                                            <span>🔴 Sinal Vermelho: 65-90% de confiança</span>
                                        </div>
                                        <div class="mt-4 p-3 bg-yellow-500 bg-opacity-20 rounded-lg">
                                            <p class="text-yellow-300 text-xs">
                                                ⚠️ Este é um sistema de demonstração. Apostas reais envolvem riscos financeiros.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Casa-specific Registration Link -->
                            <div class="mt-8 text-center">
                                <div id="casaRegistrationLink">
                                    <!-- Will be populated based on selected casa -->
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                    
                    <!-- Profile Content -->
                    <div id="profile-content" class="tab-content">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-6">Meu Perfil</h3>
                            <form id="profileForm" class="space-y-6">
                                <div class="flex items-center space-x-6">
                                    <div class="shrink-0">
                                        <img id="profileAvatar" class="h-16 w-16 object-cover rounded-full" src="" alt="Current profile photo">
                                    </div>
                                    <div>
                                        <label class="block">
                                            <span class="sr-only">Escolher foto de perfil</span>
                                            <input type="file" id="profilePhotoInput" accept="image/*" onchange="handleProfilePhotoUpload(event)" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                                        </label>
                                        <p class="mt-2 text-xs text-gray-500">PNG, JPG até 5MB</p>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <label for="profileName" class="block text-sm font-medium text-gray-700">Nome</label>
                                        <input type="text" id="profileName" name="name" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="profileEmail" class="block text-sm font-medium text-gray-700">E-mail</label>
                                        <input type="email" id="profileEmail" name="email" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                </div>
                                
                                <div>
                                    <label for="profileRole" class="block text-sm font-medium text-gray-700">Função</label>
                                    <input type="text" id="profileRole" name="role" readonly class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50 text-gray-500">
                                </div>
                                
                                <div class="border-t pt-6">
                                    <h4 class="text-md font-medium text-gray-800 mb-4">Alterar Senha</h4>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="currentPassword" class="block text-sm font-medium text-gray-700">Senha Atual</label>
                                            <input type="password" id="currentPassword" name="currentPassword" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        </div>
                                        <div>
                                            <label for="newPassword" class="block text-sm font-medium text-gray-700">Nova Senha</label>
                                            <input type="password" id="newPassword" name="newPassword" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <div class="mt-2 bg-gray-200 rounded-full h-1">
                                                <div id="passwordStrength" class="password-strength bg-gray-300"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <label for="confirmPassword" class="block text-sm font-medium text-gray-700">Confirmar Nova Senha</label>
                                            <input type="password" id="confirmPassword" name="confirmPassword" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="flex justify-end space-x-3">
                                    <button type="button" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                        Cancelar
                                    </button>
                                    <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                        Salvar Alterações
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    
                    <!-- Users Management Content (Admin Only) -->
                    <div id="users-content" class="tab-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-lg font-semibold text-gray-800">Gerenciar Usuários</h3>
                            <button onclick="openUserModal()" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center space-x-2">
                                <i class="fas fa-user-plus"></i>
                                <span>Novo Usuário</span>
                            </button>
                        </div>
                        
                        <!-- Users Table -->
                        <div class="bg-white rounded-lg shadow overflow-hidden">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Usuário</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">E-mail</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Função</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data de Criação</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody" class="bg-white divide-y divide-gray-200">
                                    <!-- Users will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Reports Content (Admin Only) -->
                    <div id="reports-content" class="tab-content">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-6">Relatórios Administrativos</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                <div class="p-6 border border-gray-200 rounded-lg hover:shadow-md transition-shadow">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="p-3 bg-blue-500 bg-opacity-10 rounded-full">
                                            <i class="fas fa-users text-blue-500 text-xl"></i>
                                        </div>
                                        <span class="text-sm text-gray-500">Atualizado há 1h</span>
                                    </div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Relatório de Usuários</h4>
                                    <p class="text-sm text-gray-600 mb-4">Análise completa dos usuários do sistema, incluindo atividade e permissões.</p>
                                    <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                                        Gerar Relatório
                                    </button>
                                </div>
                                
                                <div class="p-6 border border-gray-200 rounded-lg hover:shadow-md transition-shadow">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="p-3 bg-green-500 bg-opacity-10 rounded-full">
                                            <i class="fas fa-chart-line text-green-500 text-xl"></i>
                                        </div>
                                        <span class="text-sm text-gray-500">Atualizado há 2h</span>
                                    </div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Relatório de Atividades</h4>
                                    <p class="text-sm text-gray-600 mb-4">Monitoramento das atividades e logs de acesso do sistema.</p>
                                    <button class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                                        Gerar Relatório
                                    </button>
                                </div>
                                
                                <div class="p-6 border border-gray-200 rounded-lg hover:shadow-md transition-shadow">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="p-3 bg-purple-500 bg-opacity-10 rounded-full">
                                            <i class="fas fa-shield-alt text-purple-500 text-xl"></i>
                                        </div>
                                        <span class="text-sm text-gray-500">Atualizado há 30min</span>
                                    </div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-2">Relatório de Segurança</h4>
                                    <p class="text-sm text-gray-600 mb-4">Análise de segurança, tentativas de login e permissões.</p>
                                    <button class="w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200">
                                        Gerar Relatório
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Settings Content -->
                    <div id="settings-content" class="tab-content">
                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-6">Configurações</h3>
                            <div class="space-y-6">
                                <div>
                                    <h4 class="text-md font-medium text-gray-800 mb-4">Preferências Gerais</h4>
                                    <div class="space-y-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <label class="text-sm font-medium text-gray-700">Notificações por E-mail</label>
                                                <p class="text-sm text-gray-500">Receber notificações importantes por e-mail</p>
                                            </div>
                                            <label class="relative inline-flex items-center cursor-pointer">
                                                <input type="checkbox" checked class="sr-only peer">
                                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                            </label>
                                        </div>
                                        
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <label class="text-sm font-medium text-gray-700">Modo Escuro</label>
                                                <p class="text-sm text-gray-500">Alternar entre tema claro e escuro</p>
                                            </div>
                                            <label class="relative inline-flex items-center cursor-pointer">
                                                <input type="checkbox" class="sr-only peer">
                                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                            </label>
                                        </div>
                                        
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <label class="text-sm font-medium text-gray-700">Autenticação de Dois Fatores</label>
                                                <p class="text-sm text-gray-500">Adicionar uma camada extra de segurança</p>
                                            </div>
                                            <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-1 px-3 rounded text-sm transition duration-200">
                                                Configurar
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="border-t pt-6">
                                    <h4 class="text-md font-medium text-gray-800 mb-4">Privacidade e Segurança</h4>
                                    <div class="space-y-4">
                                        <button class="w-full text-left p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <h5 class="font-medium text-gray-800">Sessões Ativas</h5>
                                                    <p class="text-sm text-gray-500">Gerenciar dispositivos conectados</p>
                                                </div>
                                                <i class="fas fa-chevron-right text-gray-400"></i>
                                            </div>
                                        </button>
                                        
                                        <button class="w-full text-left p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <h5 class="font-medium text-gray-800">Log de Atividades</h5>
                                                    <p class="text-sm text-gray-500">Visualizar histórico de ações</p>
                                                </div>
                                                <i class="fas fa-chevron-right text-gray-400"></i>
                                            </div>
                                        </button>
                                        
                                        <button class="w-full text-left p-4 border border-red-200 rounded-lg hover:bg-red-50 transition-colors text-red-600">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <h5 class="font-medium">Excluir Conta</h5>
                                                    <p class="text-sm text-red-500">Remover permanentemente sua conta</p>
                                                </div>
                                                <i class="fas fa-chevron-right text-red-400"></i>
                                            </div>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- User Modal -->
    <div id="userModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex items-center justify-between mb-4">
                    <h3 id="modalTitle" class="text-lg font-medium text-gray-900">Novo Usuário</h3>
                    <button onclick="closeUserModal()" class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <form id="userForm" class="space-y-4">
                    <input type="hidden" id="userId" name="id">
                    <div>
                        <label for="modalUserName" class="block text-sm font-medium text-gray-700">Nome</label>
                        <input type="text" id="modalUserName" name="name" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label for="modalUserEmail" class="block text-sm font-medium text-gray-700">E-mail</label>
                        <input type="email" id="modalUserEmail" name="email" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label for="modalUserRole" class="block text-sm font-medium text-gray-700">Função</label>
                        <select id="modalUserRole" name="role" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Selecione uma função</option>
                            <option value="admin">Administrador</option>
                            <option value="user">Usuário</option>
                        </select>
                    </div>
                    <div id="passwordFields">
                        <div>
                            <label for="modalUserPassword" class="block text-sm font-medium text-gray-700">Senha</label>
                            <div class="mt-1 relative">
                                <input type="password" id="modalUserPassword" name="password" class="block w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <button type="button" onclick="togglePassword('modalUserPassword')" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <i id="modalUserPasswordToggle" class="fas fa-eye text-gray-400 hover:text-gray-600"></i>
                                </button>
                            </div>
                        </div>
                        <div>
                            <label for="modalUserPasswordConfirm" class="block text-sm font-medium text-gray-700">Confirmar Senha</label>
                            <input type="password" id="modalUserPasswordConfirm" name="passwordConfirm" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        </div>
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input id="modalUserActive" name="active" type="checkbox" checked class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                            <label for="modalUserActive" class="ml-2 block text-sm text-gray-900">
                                Usuário Ativo
                            </label>
                        </div>
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button type="button" onclick="closeUserModal()" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Cancelar
                        </button>
                        <button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Mock database
        let users = [
            {
                id: 1,
                name: 'Administrador',
                email: 'ericksitoe00@gmail.com',
                password: 'Maputo20', // In real app, this would be hashed
                role: 'admin',
                active: true,
                createdAt: '2023-01-01'
            },
            {
                id: 2,
                name: 'João Silva',
                email: 'user@empresa.com',
                password: 'user123', // In real app, this would be hashed
                role: 'user',
                active: true,
                createdAt: '2023-06-15'
            },
            {
                id: 3,
                name: 'Maria Santos',
                email: 'maria@empresa.com',
                password: 'maria123',
                role: 'user',
                active: true,
                createdAt: '2023-05-20'
            },
            {
                id: 4,
                name: 'Carlos Admin',
                email: 'carlos@empresa.com',
                password: 'carlos123',
                role: 'admin',
                active: false,
                createdAt: '2023-03-10'
            }
        ];

        let currentUser = null;
        let editingUserId = null;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainApp();
            }

            // Setup event listeners
            setupEventListeners();
        });

        function setupEventListeners() {
            // Login form
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            
            // Profile form
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
            
            // User form
            document.getElementById('userForm').addEventListener('submit', handleUserSave);
            
            // Sidebar navigation
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.addEventListener('click', handleNavigation);
            });

            // Password strength checker
            document.getElementById('newPassword').addEventListener('input', checkPasswordStrength);
        }

        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            // Find user
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user && user.active) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(user));
                showNotification('Login realizado com sucesso!', 'success');
                setTimeout(() => {
                    showMainApp();
                }, 1000);
            } else {
                showNotification('Credenciais inválidas ou usuário inativo!', 'error');
            }
        }

        function showMainApp() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            // Update user info
            updateUserInfo();
            
            // Show/hide admin menu
            if (currentUser.role === 'admin') {
                document.getElementById('adminMenu').classList.remove('hidden');
            }
            
            // Load users table for admin
            loadUsersTable();
            
            // Check if user has previously selected a casa
            const savedCasa = localStorage.getItem('selectedCasa');
            if (savedCasa && casaInfo[savedCasa]) {
                selectCasa(savedCasa);
            } else {
                // Show casa selection screen
                document.getElementById('casaSelection').classList.remove('hidden');
                document.getElementById('aviatorPredictor').classList.add('hidden');
            }
        }

        function updateUserInfo() {
            const avatarUrl = currentUser.avatar || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.name)}&background=0D8ABC&color=fff`;
            const roleText = currentUser.role === 'admin' ? 'Administrador' : 'Usuário';
            
            // Update sidebar user info
            document.getElementById('userAvatar').src = avatarUrl;
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userRole').textContent = roleText;
            
            // Update header user info
            document.getElementById('headerUserAvatar').src = avatarUrl;
            document.getElementById('headerUserName').textContent = currentUser.name;
            document.getElementById('headerUserRole').textContent = roleText;
            
            // Update profile form
            document.getElementById('profileAvatar').src = avatarUrl;
            document.getElementById('profileName').value = currentUser.name;
            document.getElementById('profileEmail').value = currentUser.email;
            document.getElementById('profileRole').value = roleText;
        }

        function handleProfilePhotoUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validate file size (5MB max)
            if (file.size > 5 * 1024 * 1024) {
                showNotification('Arquivo muito grande! Máximo 5MB permitido.', 'error');
                return;
            }
            
            // Validate file type
            if (!file.type.startsWith('image/')) {
                showNotification('Por favor, selecione apenas arquivos de imagem.', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageData = e.target.result;
                
                // Update current user avatar
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                users[userIndex].avatar = imageData;
                currentUser.avatar = imageData;
                
                // Save to localStorage
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Update UI
                updateUserInfo();
                showNotification('Foto de perfil atualizada com sucesso!', 'success');
            };
            
            reader.readAsDataURL(file);
        }

        // Casa de Apostas Selection
        let selectedCasa = null;
        const casaInfo = {
            '888bets': {
                name: '888bets',
                displayName: '888bets',
                color: 'orange',
                registrationLink: 'https://tracking.888africa.com/visit/?bta=227&brand=888mozambique',
                description: 'Casa de apostas líder em Moçambique'
            },
            'megalive': {
                name: 'megalive',
                displayName: 'Megalive Game',
                color: 'purple',
                registrationLink: 'https://www.megagamelive.com/affiliates/?btag=2345693',
                description: 'Experiência de jogo premium'
            }
        };

        // AVIATOR Predictor Variables - Realistic Algorithm
        let predictorState = {
            isPlaying: false,
            currentMultiplier: 1.00,
            gameHistory: [],
            predictions: 0,
            correctPredictions: 0,
            currentSignal: 'red',
            nextPrediction: null,
            roundCount: 0,
            isWaitingPhase: false,
            crashPoint: 1.00
        };

        // Predictor Elements
        let multiplierEl, signalBox, barFill, historyList, betMessage, progressCircle;
        let radius = 90;
        let circumference = 2 * Math.PI * radius;

        // Casa Selection Functions
        function selectCasa(casaName) {
            selectedCasa = casaName;
            localStorage.setItem('selectedCasa', casaName);
            
            // Update UI to show selected casa
            const casa = casaInfo[casaName];
            document.getElementById('selectedCasaName').textContent = casa.displayName;
            
            // Update registration link
            updateCasaRegistrationLink(casa);
            
            // Show predictor, hide selection
            document.getElementById('casaSelection').classList.add('hidden');
            document.getElementById('aviatorPredictor').classList.remove('hidden');
            
            // Initialize the game
            initializeAviatorGame();
            
            showNotification(`Casa selecionada: ${casa.displayName}!`, 'success');
        }

        function changeCasa() {
            // Hide predictor, show selection
            document.getElementById('aviatorPredictor').classList.add('hidden');
            document.getElementById('casaSelection').classList.remove('hidden');
            
            // Clear selected casa
            selectedCasa = null;
            localStorage.removeItem('selectedCasa');
        }

        function updateCasaRegistrationLink(casa) {
            const linkContainer = document.getElementById('casaRegistrationLink');
            const colorClass = casa.color === 'orange' ? 'from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700' : 'from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700';
            
            linkContainer.innerHTML = `
                <a href="${casa.registrationLink}" target="_blank" 
                   class="inline-block bg-gradient-to-r ${colorClass} text-white font-bold py-4 px-8 rounded-xl transition-all duration-200 transform hover:scale-105 text-lg">
                    🔥 Jogar no ${casa.displayName}
                </a>
                <p class="mt-3 text-gray-300 text-sm">
                    Não tem conta? <a href="${casa.registrationLink}" target="_blank" class="text-blue-300 hover:text-blue-100 underline">Criar conta grátis</a>
                </p>
            `;
        }

        function initializeAviatorGame() {
            // Initialize predictor elements
            multiplierEl = document.getElementById("multiplier");
            signalBox = document.getElementById("signalBox");
            barFill = document.getElementById("barFill");
            historyList = document.getElementById("historyList");
            betMessage = document.getElementById("betMessage");
            progressCircle = document.getElementById("progressCircle");

            // Setup progress circle
            if (progressCircle) {
                progressCircle.style.strokeDasharray = `${circumference}`;
                progressCircle.style.strokeDashoffset = `${circumference}`;
            }

            // Initialize with some history
            initializeHistory();
            runPredictorRound();
        }

        function initializeHistory() {
            // Add some realistic initial history
            const initialHistory = [2.34, 1.23, 5.67, 1.89, 3.45, 1.12, 8.90, 2.11, 1.67, 4.23];
            initialHistory.forEach(mult => {
                addToHistory(mult);
            });
        }

        function setCircleProgress(percent) {
            if (progressCircle) {
                const offset = circumference - percent / 100 * circumference;
                progressCircle.style.strokeDashoffset = offset;
            }
        }

        // Realistic Aviator multiplier generation based on actual game patterns
        function generateRealisticMultiplier() {
            const rand = Math.random();
            
            // Aviator crash distribution (approximate):
            // 50% crash between 1.00x - 2.00x
            // 25% crash between 2.00x - 5.00x  
            // 15% crash between 5.00x - 10.00x
            // 8% crash between 10.00x - 50.00x
            // 2% crash above 50.00x
            
            if (rand < 0.50) {
                // 1.00x - 2.00x (most common)
                return (1.00 + Math.random() * 1.00).toFixed(2);
            } else if (rand < 0.75) {
                // 2.00x - 5.00x
                return (2.00 + Math.random() * 3.00).toFixed(2);
            } else if (rand < 0.90) {
                // 5.00x - 10.00x
                return (5.00 + Math.random() * 5.00).toFixed(2);
            } else if (rand < 0.98) {
                // 10.00x - 50.00x
                return (10.00 + Math.random() * 40.00).toFixed(2);
            } else {
                // 50.00x+ (very rare)
                return (50.00 + Math.random() * 200.00).toFixed(2);
            }
        }

        // Advanced prediction algorithm based on pattern analysis
        function generatePrediction() {
            const history = predictorState.gameHistory.slice(0, 10);
            
            if (history.length < 5) {
                return Math.random() > 0.3 ? 'green' : 'red';
            }
            
            // Pattern analysis
            const lowCount = history.filter(x => x < 2.0).length;
            const mediumCount = history.filter(x => x >= 2.0 && x < 10.0).length;
            const highCount = history.filter(x => x >= 10.0).length;
            
            // Streak analysis
            const recentLows = history.slice(0, 3).filter(x => x < 2.0).length;
            const recentHighs = history.slice(0, 3).filter(x => x >= 3.0).length;
            
            // Calculate prediction confidence
            let greenChance = 0.25; // Base 25% chance for green
            
            // If many recent lows, increase chance of higher multiplier
            if (recentLows >= 2) {
                greenChance += 0.35;
            }
            
            // If recent high, decrease chance
            if (recentHighs >= 1) {
                greenChance -= 0.15;
            }
            
            // Pattern-based adjustments
            if (lowCount >= 7) {
                greenChance += 0.25; // Due for a higher multiplier
            }
            
            // Time-based patterns (simulate rush hours, etc.)
            const hour = new Date().getHours();
            if (hour >= 18 && hour <= 22) {
                greenChance += 0.1; // Prime time bonus
            }
            
            return Math.random() < greenChance ? 'green' : 'red';
        }

        function getPredictionMessage(signal, confidence) {
            if (signal === 'green') {
                return `🟢 SINAL VERDE - ${confidence}% Confiança`;
            } else {
                return `🔴 SINAL VERMELHO - ${confidence}% Confiança`;
            }
        }

        function addToHistory(multiplier) {
            if (historyList) {
                const span = document.createElement("span");
                const mult = parseFloat(multiplier);
                
                let bgClass, textClass;
                if (mult < 2.0) {
                    bgClass = 'bg-red-500';
                    textClass = 'text-white';
                } else if (mult < 10.0) {
                    bgClass = 'bg-yellow-500';
                    textClass = 'text-black';
                } else {
                    bgClass = 'bg-green-500';
                    textClass = 'text-white';
                }
                
                span.className = `px-3 py-1 rounded-full text-sm font-semibold ${bgClass} ${textClass}`;
                span.textContent = multiplier + "x";
                historyList.prepend(span);
                
                if (historyList.children.length > 15) {
                    historyList.removeChild(historyList.lastChild);
                }
            }

            // Update game history
            predictorState.gameHistory.unshift(parseFloat(multiplier));
            if (predictorState.gameHistory.length > 20) {
                predictorState.gameHistory.pop();
            }
        }

        function updatePredictorUI(multiplier, isLive = false) {
            if (multiplierEl) {
                multiplierEl.textContent = multiplier + "x";
            }
            
            if (!isLive) {
                // Generate next prediction
                const signal = generatePrediction();
                const confidence = signal === 'green' ? Math.floor(85 + Math.random() * 15) : Math.floor(65 + Math.random() * 25);
                
                predictorState.currentSignal = signal;
                predictorState.nextPrediction = { signal, confidence };
                
                if (signalBox) {
                    signalBox.className = `text-center py-3 px-6 rounded-xl font-bold text-lg mb-4 ${signal === 'green' ? 'bg-green-700' : 'bg-red-700'}`;
                    signalBox.textContent = getPredictionMessage(signal, confidence);
                }

                addToHistory(multiplier);
            }
        }

        function runPredictorRound() {
            predictorState.roundCount++;
            predictorState.isWaitingPhase = true;
            
            // Generate crash point
            const crashPoint = parseFloat(generateRealisticMultiplier());
            predictorState.crashPoint = crashPoint;
            
            // Show waiting phase
            if (betMessage) {
                betMessage.innerHTML = '⏳ Aguardando próxima rodada...';
                betMessage.style.display = "block";
            }
            
            if (barFill) {
                barFill.style.width = "0%";
            }
            setCircleProgress(0);
            
            // Waiting phase (5 seconds)
            setTimeout(() => {
                startFlightPhase(crashPoint);
            }, 5000);
        }

        function startFlightPhase(crashPoint) {
            predictorState.isWaitingPhase = false;
            predictorState.isPlaying = true;
            
            if (betMessage) {
                betMessage.innerHTML = '🚀 Voando... Retire seus ganhos!';
            }
            
            let currentMult = 1.00;
            let progress = 0;
            
            // Flight animation
            const flightInterval = setInterval(() => {
                progress += 1;
                currentMult = 1.00 + (progress * (crashPoint - 1.00) / 100);
                
                if (multiplierEl) {
                    multiplierEl.textContent = currentMult.toFixed(2) + "x";
                }
                
                if (barFill) {
                    barFill.style.width = `${progress}%`;
                }
                setCircleProgress(progress);
                
                // Crash when reaching crash point
                if (progress >= 100 || currentMult >= crashPoint) {
                    clearInterval(flightInterval);
                    crashGame(crashPoint);
                }
            }, 100);
        }

        function crashGame(finalMultiplier) {
            predictorState.isPlaying = false;
            
            if (betMessage) {
                betMessage.innerHTML = `💥 Crashed at ${finalMultiplier}x`;
                betMessage.style.color = '#ef4444';
            }
            
            // Update UI with final result
            updatePredictorUI(finalMultiplier, false);
            
            // Check prediction accuracy
            const wasCorrect = checkPredictionAccuracy(finalMultiplier);
            if (wasCorrect) {
                predictorState.correctPredictions++;
            }
            predictorState.predictions++;
            
            // Reset for next round
            setTimeout(() => {
                if (betMessage) {
                    betMessage.style.color = '#fbbf24';
                }
                runPredictorRound();
            }, 3000);
        }

        function checkPredictionAccuracy(multiplier) {
            if (!predictorState.nextPrediction) return false;
            
            const { signal } = predictorState.nextPrediction;
            const mult = parseFloat(multiplier);
            
            if (signal === 'green' && mult >= 2.5) {
                return true;
            } else if (signal === 'red' && mult < 2.5) {
                return true;
            }
            
            return false;
        }



        function loadUsersTable() {
            if (currentUser.role !== 'admin') return;
            
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                const avatarUrl = user.avatar || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.name)}&background=0D8ABC&color=fff`;
                const roleText = user.role === 'admin' ? 'Administrador' : 'Usuário';
                const statusClass = user.active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800';
                const statusText = user.active ? 'Ativo' : 'Inativo';
                
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10">
                                <img class="h-10 w-10 rounded-full" src="${avatarUrl}" alt="">
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">${user.name}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${user.email}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${user.role === 'admin' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'}">
                            ${roleText}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">
                            ${statusText}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${formatDate(user.createdAt)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editUser(${user.id})" class="text-blue-600 hover:text-blue-900 mr-3">
                            <i class="fas fa-edit"></i>
                        </button>
                        ${user.id !== currentUser.id ? `
                            <button onclick="deleteUser(${user.id})" class="text-red-600 hover:text-red-900">
                                <i class="fas fa-trash"></i>
                            </button>
                        ` : ''}
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function handleNavigation(e) {
            e.preventDefault();
            
            const target = e.currentTarget.getAttribute('href').substring(1);
            
            // Check permissions
            if ((target === 'users' || target === 'reports') && currentUser.role !== 'admin') {
                showNotification('Acesso negado! Apenas administradores podem acessar esta área.', 'error');
                return;
            }
            
            // Update active link
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });
            e.currentTarget.classList.add('active');
            
            // Show content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(target + '-content').classList.add('active');
            
            // Update page title
            const titles = {
                'aviator': 'AVIATOR',
                'profile': 'Meu Perfil',
                'users': 'Gerenciar Usuários',
                'reports': 'Relatórios Administrativos',
                'settings': 'Configurações'
            };
            document.getElementById('pageTitle').textContent = titles[target] || 'AVIATOR';
        }

        function openUserModal(userId = null) {
            editingUserId = userId;
            const modal = document.getElementById('userModal');
            const title = document.getElementById('modalTitle');
            const form = document.getElementById('userForm');
            
            if (userId) {
                const user = users.find(u => u.id === userId);
                title.textContent = 'Editar Usuário';
                document.getElementById('userId').value = user.id;
                document.getElementById('modalUserName').value = user.name;
                document.getElementById('modalUserEmail').value = user.email;
                document.getElementById('modalUserRole').value = user.role;
                document.getElementById('modalUserActive').checked = user.active;
                document.getElementById('passwordFields').style.display = 'none';
            } else {
                title.textContent = 'Novo Usuário';
                form.reset();
                document.getElementById('passwordFields').style.display = 'block';
                document.getElementById('modalUserPassword').required = true;
                document.getElementById('modalUserPasswordConfirm').required = true;
            }
            
            modal.classList.remove('hidden');
        }

        function closeUserModal() {
            document.getElementById('userModal').classList.add('hidden');
            editingUserId = null;
        }

        function handleUserSave(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const userData = {
                name: formData.get('name'),
                email: formData.get('email'),
                role: formData.get('role'),
                active: formData.get('active') === 'on'
            };
            
            // Validate email uniqueness
            const existingUser = users.find(u => u.email === userData.email && u.id !== editingUserId);
            if (existingUser) {
                showNotification('Este e-mail já está em uso!', 'error');
                return;
            }
            
            if (editingUserId) {
                // Update existing user
                const userIndex = users.findIndex(u => u.id === editingUserId);
                users[userIndex] = { ...users[userIndex], ...userData };
                showNotification('Usuário atualizado com sucesso!', 'success');
            } else {
                // Create new user
                const password = formData.get('password');
                const passwordConfirm = formData.get('passwordConfirm');
                
                if (password !== passwordConfirm) {
                    showNotification('As senhas não coincidem!', 'error');
                    return;
                }
                
                const newUser = {
                    id: Math.max(...users.map(u => u.id)) + 1,
                    ...userData,
                    password: password, // In real app, this would be hashed
                    createdAt: new Date().toISOString().split('T')[0]
                };
                
                users.push(newUser);
                showNotification('Usuário criado com sucesso!', 'success');
            }
            
            loadUsersTable();
            loadDashboardData();
            closeUserModal();
        }

        function editUser(userId) {
            openUserModal(userId);
        }

        function deleteUser(userId) {
            if (userId === currentUser.id) {
                showNotification('Você não pode excluir sua própria conta!', 'error');
                return;
            }
            
            if (confirm('Tem certeza que deseja excluir este usuário?')) {
                users = users.filter(u => u.id !== userId);
                loadUsersTable();
                loadDashboardData();
                showNotification('Usuário excluído com sucesso!', 'success');
            }
        }

        function handleProfileUpdate(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const name = formData.get('name');
            const email = formData.get('email');
            const currentPassword = formData.get('currentPassword');
            const newPassword = formData.get('newPassword');
            const confirmPassword = formData.get('confirmPassword');
            
            // Validate email uniqueness
            const existingUser = users.find(u => u.email === email && u.id !== currentUser.id);
            if (existingUser) {
                showNotification('Este e-mail já está em uso!', 'error');
                return;
            }
            
            // Update basic info
            const userIndex = users.findIndex(u => u.id === currentUser.id);
            users[userIndex].name = name;
            users[userIndex].email = email;
            
            // Update password if provided
            if (currentPassword && newPassword) {
                if (users[userIndex].password !== currentPassword) {
                    showNotification('Senha atual incorreta!', 'error');
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    showNotification('As novas senhas não coincidem!', 'error');
                    return;
                }
                
                users[userIndex].password = newPassword;
            }
            
            // Update current user and localStorage
            currentUser = users[userIndex];
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            updateUserInfo();
            showNotification('Perfil atualizado com sucesso!', 'success');
        }

        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const toggle = document.getElementById(inputId + 'Toggle');
            
            if (input.type === 'password') {
                input.type = 'text';
                toggle.classList.remove('fa-eye');
                toggle.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                toggle.classList.remove('fa-eye-slash');
                toggle.classList.add('fa-eye');
            }
        }

        function checkPasswordStrength() {
            const password = document.getElementById('newPassword').value;
            const strengthBar = document.getElementById('passwordStrength');
            
            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;
            
            strengthBar.className = 'password-strength';
            if (strength <= 1) {
                strengthBar.classList.add('strength-weak');
            } else if (strength <= 2) {
                strengthBar.classList.add('strength-medium');
            } else {
                strengthBar.classList.add('strength-strong');
            }
        }

        function fillCredentials(email, password) {
            document.getElementById('email').value = email;
            document.getElementById('password').value = password;
        }

        function logout() {
            localStorage.removeItem('currentUser');
            currentUser = null;
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('loginForm').reset();
            showNotification('Logout realizado com sucesso!', 'success');
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notificationIcon');
            const messageEl = document.getElementById('notificationMessage');
            
            messageEl.textContent = message;
            
            if (type === 'success') {
                icon.innerHTML = '<i class="fas fa-check-circle text-green-500 text-xl"></i>';
            } else {
                icon.innerHTML = '<i class="fas fa-exclamation-circle text-red-500 text-xl"></i>';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                hideNotification();
            }, 5000);
        }

        function hideNotification() {
            document.getElementById('notification').classList.remove('show');
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('pt-BR');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'969e2ab545b5739e',t:'MTc1NDMxMTY4My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
